!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";function r(t,e){var n=e.x-t.x,r=e.y-t.y;return 0===n?r>=0?180:0:n>0?180-(Math.atan(r/n)*(180/Math.PI)-90):-(Math.atan(r/n)*(180/Math.PI)-90)}function i(t){if(void 0===window.reach_resource_prefix)return t;var e=t.toLowerCase();return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("#")?t:window.reach_resource_prefix.concat(t)}function o(t,e){return 2*t*Math.sin(e/2)}function a(t,e,n){var r=c(n.direction)-c(e.direction),i=d(n.inclination)-d(e.inclination);return{width:o(t,r),height:o(t,i)}}function s(t,e){return(t+e)/2}function u(t){var e=t.split(" ");return{corner1:{direction:parseFloat(e[0]),inclination:parseFloat(e[1])},corner2:{direction:parseFloat(e[2]),inclination:parseFloat(e[3])}}}function c(t){return t%12/-12*2*Math.PI}function d(t){return t%12/12*2*Math.PI}function l(t,e,n={}){var r=n;if(t){var i=t.split(" ");for(var o in i){var a=i[o],s=window.reachMixins[a];if(s)for(var u in s)s[u]&&(r[u]=s[u]);else console.log(`Reach Warning: mixin not found: ${a}`)}}for(var c in e)e[c]&&(r[c]=e[c]);return r.mixin=void 0,r}n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"g",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"h",(function(){return u})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return p})),n.d(e,"f",(function(){return l}));const h="reach_default_null_754",p=-9999},function(t,e,n){(function(t,n){var r;!function(){var i="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this||{},o=i._,a=Array.prototype,s=Object.prototype,u="undefined"!=typeof Symbol?Symbol.prototype:null,c=a.push,d=a.slice,l=s.toString,h=s.hasOwnProperty,p=Array.isArray,f=Object.keys,g=Object.create,y=function(){},v=function(t){return t instanceof v?t:this instanceof v?void(this._wrapped=t):new v(t)};e.nodeType?i._=v:(!n.nodeType&&n.exports&&(e=n.exports=v),e._=v),v.VERSION="1.9.1";var m,b=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}},_=function(t,e,n){return v.iteratee!==m?v.iteratee(t,e):null==t?v.identity:v.isFunction(t)?b(t,e,n):v.isObject(t)&&!v.isArray(t)?v.matcher(t):v.property(t)};v.iteratee=m=function(t,e){return _(t,e,1/0)};var w=function(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var o=Array(e+1);for(i=0;i<e;i++)o[i]=arguments[i];return o[e]=r,t.apply(this,o)}},k=function(t){if(!v.isObject(t))return{};if(g)return g(t);y.prototype=t;var e=new y;return y.prototype=null,e},A=function(t){return function(e){return null==e?void 0:e[t]}},E=function(t,e){return null!=t&&h.call(t,e)},x=function(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0},O=Math.pow(2,53)-1,C=A("length"),j=function(t){var e=C(t);return"number"==typeof e&&0<=e&&e<=O};v.each=v.forEach=function(t,e,n){var r,i;if(e=b(e,n),j(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var o=v.keys(t);for(r=0,i=o.length;r<i;r++)e(t[o[r]],o[r],t)}return t},v.map=v.collect=function(t,e,n){e=_(e,n);for(var r=!j(t)&&v.keys(t),i=(r||t).length,o=Array(i),a=0;a<i;a++){var s=r?r[a]:a;o[a]=e(t[s],s,t)}return o};var S=function(t){return function(e,n,r,i){var o=3<=arguments.length;return function(e,n,r,i){var o=!j(e)&&v.keys(e),a=(o||e).length,s=0<t?0:a-1;for(i||(r=e[o?o[s]:s],s+=t);0<=s&&s<a;s+=t){var u=o?o[s]:s;r=n(r,e[u],u,e)}return r}(e,b(n,i,4),r,o)}};v.reduce=v.foldl=v.inject=S(1),v.reduceRight=v.foldr=S(-1),v.find=v.detect=function(t,e,n){var r=(j(t)?v.findIndex:v.findKey)(t,e,n);if(void 0!==r&&-1!==r)return t[r]},v.filter=v.select=function(t,e,n){var r=[];return e=_(e,n),v.each(t,(function(t,n,i){e(t,n,i)&&r.push(t)})),r},v.reject=function(t,e,n){return v.filter(t,v.negate(_(e)),n)},v.every=v.all=function(t,e,n){e=_(e,n);for(var r=!j(t)&&v.keys(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(!e(t[a],a,t))return!1}return!0},v.some=v.any=function(t,e,n){e=_(e,n);for(var r=!j(t)&&v.keys(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(e(t[a],a,t))return!0}return!1},v.contains=v.includes=v.include=function(t,e,n,r){return j(t)||(t=v.values(t)),("number"!=typeof n||r)&&(n=0),0<=v.indexOf(t,e,n)},v.invoke=w((function(t,e,n){var r,i;return v.isFunction(e)?i=e:v.isArray(e)&&(r=e.slice(0,-1),e=e[e.length-1]),v.map(t,(function(t){var o=i;if(!o){if(r&&r.length&&(t=x(t,r)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)}))})),v.pluck=function(t,e){return v.map(t,v.property(e))},v.where=function(t,e){return v.filter(t,v.matcher(e))},v.findWhere=function(t,e){return v.find(t,v.matcher(e))},v.max=function(t,e,n){var r,i,o=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var s=0,u=(t=j(t)?t:v.values(t)).length;s<u;s++)null!=(r=t[s])&&o<r&&(o=r);else e=_(e,n),v.each(t,(function(t,n,r){i=e(t,n,r),(a<i||i===-1/0&&o===-1/0)&&(o=t,a=i)}));return o},v.min=function(t,e,n){var r,i,o=1/0,a=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var s=0,u=(t=j(t)?t:v.values(t)).length;s<u;s++)null!=(r=t[s])&&r<o&&(o=r);else e=_(e,n),v.each(t,(function(t,n,r){((i=e(t,n,r))<a||i===1/0&&o===1/0)&&(o=t,a=i)}));return o},v.shuffle=function(t){return v.sample(t,1/0)},v.sample=function(t,e,n){if(null==e||n)return j(t)||(t=v.values(t)),t[v.random(t.length-1)];var r=j(t)?v.clone(t):v.values(t),i=C(r);e=Math.max(Math.min(e,i),0);for(var o=i-1,a=0;a<e;a++){var s=v.random(a,o),u=r[a];r[a]=r[s],r[s]=u}return r.slice(0,e)},v.sortBy=function(t,e,n){var r=0;return e=_(e,n),v.pluck(v.map(t,(function(t,n,i){return{value:t,index:r++,criteria:e(t,n,i)}})).sort((function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index})),"value")};var M=function(t,e){return function(n,r,i){var o=e?[[],[]]:{};return r=_(r,i),v.each(n,(function(e,i){var a=r(e,i,n);t(o,e,a)})),o}};v.groupBy=M((function(t,e,n){E(t,n)?t[n].push(e):t[n]=[e]})),v.indexBy=M((function(t,e,n){t[n]=e})),v.countBy=M((function(t,e,n){E(t,n)?t[n]++:t[n]=1}));var D=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;v.toArray=function(t){return t?v.isArray(t)?d.call(t):v.isString(t)?t.match(D):j(t)?v.map(t,v.identity):v.values(t):[]},v.size=function(t){return null==t?0:j(t)?t.length:v.keys(t).length},v.partition=M((function(t,e,n){t[n?0:1].push(e)}),!0),v.first=v.head=v.take=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[0]:v.initial(t,t.length-e)},v.initial=function(t,e,n){return d.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},v.last=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[t.length-1]:v.rest(t,Math.max(0,t.length-e))},v.rest=v.tail=v.drop=function(t,e,n){return d.call(t,null==e||n?1:e)},v.compact=function(t){return v.filter(t,Boolean)};var I=function(t,e,n,r){for(var i=(r=r||[]).length,o=0,a=C(t);o<a;o++){var s=t[o];if(j(s)&&(v.isArray(s)||v.isArguments(s)))if(e)for(var u=0,c=s.length;u<c;)r[i++]=s[u++];else I(s,e,n,r),i=r.length;else n||(r[i++]=s)}return r};v.flatten=function(t,e){return I(t,e,!1)},v.without=w((function(t,e){return v.difference(t,e)})),v.uniq=v.unique=function(t,e,n,r){v.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=_(n,r));for(var i=[],o=[],a=0,s=C(t);a<s;a++){var u=t[a],c=n?n(u,a,t):u;e&&!n?(a&&o===c||i.push(u),o=c):n?v.contains(o,c)||(o.push(c),i.push(u)):v.contains(i,u)||i.push(u)}return i},v.union=w((function(t){return v.uniq(I(t,!0,!0))})),v.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=C(t);r<i;r++){var o=t[r];if(!v.contains(e,o)){var a;for(a=1;a<n&&v.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},v.difference=w((function(t,e){return e=I(e,!0,!0),v.filter(t,(function(t){return!v.contains(e,t)}))})),v.unzip=function(t){for(var e=t&&v.max(t,C).length||0,n=Array(e),r=0;r<e;r++)n[r]=v.pluck(t,r);return n},v.zip=w(v.unzip),v.object=function(t,e){for(var n={},r=0,i=C(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n};var F=function(t){return function(e,n,r){n=_(n,r);for(var i=C(e),o=0<t?0:i-1;0<=o&&o<i;o+=t)if(n(e[o],o,e))return o;return-1}};v.findIndex=F(1),v.findLastIndex=F(-1),v.sortedIndex=function(t,e,n,r){for(var i=(n=_(n,r,1))(e),o=0,a=C(t);o<a;){var s=Math.floor((o+a)/2);n(t[s])<i?o=s+1:a=s}return o};var $=function(t,e,n){return function(r,i,o){var a=0,s=C(r);if("number"==typeof o)0<t?a=0<=o?o:Math.max(o+s,a):s=0<=o?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return r[o=n(r,i)]===i?o:-1;if(i!=i)return 0<=(o=e(d.call(r,a,s),v.isNaN))?o+a:-1;for(o=0<t?a:s-1;0<=o&&o<s;o+=t)if(r[o]===i)return o;return-1}};v.indexOf=$(1,v.findIndex,v.sortedIndex),v.lastIndexOf=$(-1,v.findLastIndex),v.range=function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;o<r;o++,t+=n)i[o]=t;return i},v.chunk=function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,i=t.length;r<i;)n.push(d.call(t,r,r+=e));return n};var P=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=k(t.prototype),a=t.apply(o,i);return v.isObject(a)?a:o};v.bind=w((function(t,e,n){if(!v.isFunction(t))throw new TypeError("Bind must be called on a function");var r=w((function(i){return P(t,r,e,this,n.concat(i))}));return r})),v.partial=w((function(t,e){var n=v.partial.placeholder,r=function(){for(var i=0,o=e.length,a=Array(o),s=0;s<o;s++)a[s]=e[s]===n?arguments[i++]:e[s];for(;i<arguments.length;)a.push(arguments[i++]);return P(t,r,this,this,a)};return r})),(v.partial.placeholder=v).bindAll=w((function(t,e){var n=(e=I(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=v.bind(t[r],t)}})),v.memoize=function(t,e){var n=function(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return E(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n},v.delay=w((function(t,e,n){return setTimeout((function(){return t.apply(null,n)}),e)})),v.defer=v.partial(v.delay,v,1),v.throttle=function(t,e,n){var r,i,o,a,s=0;n||(n={});var u=function(){s=!1===n.leading?0:v.now(),r=null,a=t.apply(i,o),r||(i=o=null)},c=function(){var c=v.now();s||!1!==n.leading||(s=c);var d=e-(c-s);return i=this,o=arguments,d<=0||e<d?(r&&(clearTimeout(r),r=null),s=c,a=t.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(u,d)),a};return c.cancel=function(){clearTimeout(r),s=0,r=i=o=null},c},v.debounce=function(t,e,n){var r,i,o=function(e,n){r=null,n&&(i=t.apply(e,n))},a=w((function(a){if(r&&clearTimeout(r),n){var s=!r;r=setTimeout(o,e),s&&(i=t.apply(this,a))}else r=v.delay(o,e,this,a);return i}));return a.cancel=function(){clearTimeout(r),r=null},a},v.wrap=function(t,e){return v.partial(e,t)},v.negate=function(t){return function(){return!t.apply(this,arguments)}},v.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},v.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},v.before=function(t,e){var n;return function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},v.once=v.partial(v.before,2),v.restArguments=w;var q=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],L=function(t,e){var n=R.length,r=t.constructor,i=v.isFunction(r)&&r.prototype||s,o="constructor";for(E(t,o)&&!v.contains(e,o)&&e.push(o);n--;)(o=R[n])in t&&t[o]!==i[o]&&!v.contains(e,o)&&e.push(o)};v.keys=function(t){if(!v.isObject(t))return[];if(f)return f(t);var e=[];for(var n in t)E(t,n)&&e.push(n);return q&&L(t,e),e},v.allKeys=function(t){if(!v.isObject(t))return[];var e=[];for(var n in t)e.push(n);return q&&L(t,e),e},v.values=function(t){for(var e=v.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r},v.mapObject=function(t,e,n){e=_(e,n);for(var r=v.keys(t),i=r.length,o={},a=0;a<i;a++){var s=r[a];o[s]=e(t[s],s,t)}return o},v.pairs=function(t){for(var e=v.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},v.invert=function(t){for(var e={},n=v.keys(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e},v.functions=v.methods=function(t){var e=[];for(var n in t)v.isFunction(t[n])&&e.push(n);return e.sort()};var H=function(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],a=t(o),s=a.length,u=0;u<s;u++){var c=a[u];e&&void 0!==n[c]||(n[c]=o[c])}return n}};v.extend=H(v.allKeys),v.extendOwn=v.assign=H(v.keys),v.findKey=function(t,e,n){e=_(e,n);for(var r,i=v.keys(t),o=0,a=i.length;o<a;o++)if(e(t[r=i[o]],r,t))return r};var B,T,N=function(t,e,n){return e in n};v.pick=w((function(t,e){var n={},r=e[0];if(null==t)return n;v.isFunction(r)?(1<e.length&&(r=b(r,e[1])),e=v.allKeys(t)):(r=N,e=I(e,!1,!1),t=Object(t));for(var i=0,o=e.length;i<o;i++){var a=e[i],s=t[a];r(s,a,t)&&(n[a]=s)}return n})),v.omit=w((function(t,e){var n,r=e[0];return v.isFunction(r)?(r=v.negate(r),1<e.length&&(n=e[1])):(e=v.map(I(e,!1,!1),String),r=function(t,n){return!v.contains(e,n)}),v.pick(t,r,n)})),v.defaults=H(v.allKeys,!0),v.create=function(t,e){var n=k(t);return e&&v.extendOwn(n,e),n},v.clone=function(t){return v.isObject(t)?v.isArray(t)?t.slice():v.extend({},t):t},v.tap=function(t,e){return e(t),t},v.isMatch=function(t,e){var n=v.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var a=n[o];if(e[a]!==i[a]||!(a in i))return!1}return!0},B=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"===i||"object"===i||"object"==typeof e)&&T(t,e,n,r)},T=function(t,e,n,r){t instanceof v&&(t=t._wrapped),e instanceof v&&(e=e._wrapped);var i=l.call(t);if(i!==l.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return u.valueOf.call(t)===u.valueOf.call(e)}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(v.isFunction(a)&&a instanceof a&&v.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var c=(n=n||[]).length;c--;)if(n[c]===t)return r[c]===e;if(n.push(t),r.push(e),o){if((c=t.length)!==e.length)return!1;for(;c--;)if(!B(t[c],e[c],n,r))return!1}else{var d,h=v.keys(t);if(c=h.length,v.keys(e).length!==c)return!1;for(;c--;)if(d=h[c],!E(e,d)||!B(t[d],e[d],n,r))return!1}return n.pop(),r.pop(),!0},v.isEqual=function(t,e){return B(t,e)},v.isEmpty=function(t){return null==t||(j(t)&&(v.isArray(t)||v.isString(t)||v.isArguments(t))?0===t.length:0===v.keys(t).length)},v.isElement=function(t){return!(!t||1!==t.nodeType)},v.isArray=p||function(t){return"[object Array]"===l.call(t)},v.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},v.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],(function(t){v["is"+t]=function(e){return l.call(e)==="[object "+t+"]"}})),v.isArguments(arguments)||(v.isArguments=function(t){return E(t,"callee")});var W=i.document&&i.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof W&&(v.isFunction=function(t){return"function"==typeof t||!1}),v.isFinite=function(t){return!v.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},v.isNaN=function(t){return v.isNumber(t)&&isNaN(t)},v.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===l.call(t)},v.isNull=function(t){return null===t},v.isUndefined=function(t){return void 0===t},v.has=function(t,e){if(!v.isArray(e))return E(t,e);for(var n=e.length,r=0;r<n;r++){var i=e[r];if(null==t||!h.call(t,i))return!1;t=t[i]}return!!n},v.noConflict=function(){return i._=o,this},v.identity=function(t){return t},v.constant=function(t){return function(){return t}},v.noop=function(){},v.property=function(t){return v.isArray(t)?function(e){return x(e,t)}:A(t)},v.propertyOf=function(t){return null==t?function(){}:function(e){return v.isArray(e)?x(t,e):t[e]}},v.matcher=v.matches=function(t){return t=v.extendOwn({},t),function(e){return v.isMatch(e,t)}},v.times=function(t,e,n){var r=Array(Math.max(0,t));e=b(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},v.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},v.now=Date.now||function(){return(new Date).getTime()};var K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},z=v.invert(K),U=function(t){var e=function(e){return t[e]},n="(?:"+v.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};v.escape=U(K),v.unescape=U(z),v.result=function(t,e,n){v.isArray(e)||(e=[e]);var r=e.length;if(!r)return v.isFunction(n)?n.call(t):n;for(var i=0;i<r;i++){var o=null==t?void 0:t[e[i]];void 0===o&&(o=n,i=r),t=v.isFunction(o)?o.call(t):o}return t};var J=0;v.uniqueId=function(t){var e=++J+"";return t?t+e:e},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Q=/\\|'|\r|\n|\u2028|\u2029/g,X=function(t){return"\\"+G[t]};v.template=function(t,e,n){!e&&n&&(e=n),e=v.defaults({},e,v.templateSettings);var r,i=RegExp([(e.escape||V).source,(e.interpolate||V).source,(e.evaluate||V).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(i,(function(e,n,r,i,s){return a+=t.slice(o,s).replace(Q,X),o=s+e.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),e})),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{r=new Function(e.variable||"obj","_",a)}catch(e){throw e.source=a,e}var s=function(t){return r.call(this,t,v)},u=e.variable||"obj";return s.source="function("+u+"){\n"+a+"}",s},v.chain=function(t){var e=v(t);return e._chain=!0,e};var Y=function(t,e){return t._chain?v(e).chain():e};v.mixin=function(t){return v.each(v.functions(t),(function(e){var n=v[e]=t[e];v.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),Y(this,n.apply(v,t))}})),v},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=a[t];v.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],Y(this,n)}})),v.each(["concat","join","slice"],(function(t){var e=a[t];v.prototype[t]=function(){return Y(this,e.apply(this._wrapped,arguments))}})),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return String(this._wrapped)},void 0===(r=function(){return v}.apply(e,[]))||(n.exports=r)}()}).call(this,n(3),n(4)(t))},function(t,e,n){"use strict";n.r(e);var r=n(1);n(5);window._=r},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(module,__webpack_exports__,__webpack_require__){"use strict";var _underscore_min_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_underscore_min_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_underscore_min_js__WEBPACK_IMPORTED_MODULE_0__),_reach_passage_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(12),_reach_text_panel_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6),_reach_image_panel_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7),_reach_sound_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8),_reach_sky_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9),_reach_video_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(10),_arrow_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(11),_utility_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(0),storyDocument,startnode;console.log("REACH-1.0.0,45"),AFRAME.registerComponent("reach_passage_link",{schema:{event:{type:"string",default:""},name:{type:"string",default:""}},init:function(){var t=this;this.eventHandlerFn=function(){window.story.show(t.data.name)}},update:function(t){var e=this.data,n=this.el;t.event&&e.event!==t.event&&n.removeEventListener(t.event,this.eventHandlerFn),e.event&&n.addEventListener(e.event,this.eventHandlerFn)},remove:function(){var t=this.data,e=this.el;t.event&&e.removeEventListener(t.event,this.eventHandlerFn)}}),AFRAME.registerComponent("reach_rotation_reader",{init:function(){this.hudtext=document.querySelector("#hudtext")},tick:function(){this.hudtext.setAttribute("text",`value: dir:${(this.el.object3D.rotation.y/(2*Math.PI)*-12%12).toFixed(2)} ele:${(this.el.object3D.rotation.x/(2*Math.PI)*12%12).toFixed(2)}`)}}),AFRAME.registerComponent("reach-load-local",{init:function(){storyDocument=document,console.log("here"),document.querySelector("a-scene").setAttribute("cursor","rayOrigin: mouse"),document.querySelector("a-scene").setAttribute("raycaster","objects: .clickable");var storyData=storyDocument.querySelector("tw-storydata");startnode=storyData.getAttribute("startnode");for(var userScripts=storyDocument.querySelector("tw-storydata").querySelectorAll('*[type="text/twine-javascript"]'),passagesByID={},passagesByName={},passagesArray=storyData.querySelectorAll("tw-passagedata"),i=0;i<passagesArray.length;i++){var id=passagesArray[i].getAttribute("pid"),name=passagesArray[i].getAttribute("name");null!=id&&(passagesByID[id]=passagesArray[i]),null!=name&&(passagesByName[name]=passagesArray[i])}window.story={name:storyData.getAttribute("name"),startnode:storyData.getAttribute("startnode"),creator:storyData.getAttribute("creator"),creatorVersion:storyData.getAttribute("creator-version"),ifid:storyData.getAttribute("ifid"),zoom:storyData.getAttribute("zoom"),format:storyData.getAttribute("format"),formatVersion:storyData.getAttribute("format-version"),options:storyData.getAttribute("options"),history:[],state:{},userScripts:userScripts,checkpointName:"",atCheckpoing:!1,passages:passagesByID,passagesByName:passagesByName,currentCursor:void 0,hud:void 0},window.passage={},window.reachMixins={},window.registerMixin=function(t,e){reachMixins[t]=e},window.story.passage=function(t){return null!=window.story.passages[t]?window.story.passages[t]:window.story.passagesByName[t]},window.story.render=function(t){var e=window.story.passage(t);if(void 0!==e)return _.template(e.textContent)({s:window.story.state});console.log("Error: passage was not found: "+t)},window.story.show=function(t,e){var n=document.querySelectorAll("video");if(null!==n)for(var r=0;r<n.length;r++)console.log(`pausing video ${r}`),n[r].pause();document.querySelector("#container").setAttribute("reach_passage",{id:t,name:t,hideFromHistory:e}),document.querySelector("a-scene").setAttribute("background","color: black")},window.story.start=function(){window.story.show(window.story.startnode)},window.story.stats=function(t){!0===t?document.querySelector("a-scene").setAttribute("stats",!0):document.querySelector("a-scene").removeAttribute("stats")},window.story.cursor=function(t){if(!0===t){if(void 0===window.story.currentCursor){var e=document.createElement("a-entity");e.setAttribute("cursor",""),window.story.currentCursor=e,e.setAttribute("raycaster","objects: .clickable"),e.setAttribute("animation__click","property: scale; startEvents: click; easing: easeInCubic; dur: 150; from: 0.1 0.1 0.1; to: 1 1 1"),e.setAttribute("animation__mouseenter","property: scale; startEvents: mouseenter; easing: easeInCubic; dur: 100; from: 1 1 1; to: 1.2 1.2 1.2"),e.setAttribute("animation__mouseleave","property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 100; to: 1 1 1"),e.setAttribute("material","color: black; shader: flat"),e.setAttribute("position","0 0 -1"),e.setAttribute("geometry","primitive: ring; radiusInner: 0.01; radiusOuter: 0.02;"),document.querySelector("#main-camera").appendChild(e)}}else null!=window.story.currentCursor&&(document.querySelector("#main-camera").removeChild(window.story.currentCursor),window.story.currentCursor=void 0)},window.story.lookPosition=function(t){if(!0===t){if(void 0===window.story.hud){var e=document.createElement("a-entity");e.setAttribute("position","0 0 -1"),e.setAttribute("text","value: 0 0"),e.setAttribute("id","hudtext"),e.setAttribute("geometry","primitive: plane; width:auto; height:auto};"),e.setAttribute("material","color:  #000000;  shader:  flat; opacity: 0.3;"),window.story.hud=e;var n=document.querySelector("a-camera");n.appendChild(e),n.setAttribute("reach_rotation_reader","")}}else void 0!==window.story.hud&&(document.querySelector("a-camera").removeChild(window.story.hud),document.querySelector("a-camera").removeAttribute("reach_rotation_reader"),window.story.hud=void 0)},window.story.isMobile=function(){return AFRAME.utils.device.isMobile()},window.story.headsetConnected=function(){return AFRAME.utils.device.checkHeadsetConnected()};for(var i=0;i<userScripts.length;i++){var script=userScripts[i].innerHTML;try{eval(script)}catch(t){console.log(t)}}if(null!==window.reach_preload_images){var count=0,current=0;for(var i in window.reach_preload_images){count+=1;var idTag=i,src=Object(_utility_js__WEBPACK_IMPORTED_MODULE_8__.e)(window.reach_preload_images[i]),img=document.createElement("img");img.setAttribute("crossorigin","anonymous"),img.setAttribute("id",idTag),img.setAttribute("src",src),img.addEventListener("load",(function(t){current+=1,console.log(`loaded ${current} of ${count} images`)})),storyDocument.querySelector("a-assets").appendChild(img)}}!0===window.story.isMobile()&&window.story.cursor(!0),window.story.start()}});var loadedScene=document.querySelector("a-scene");null!=loadedScene&&loadedScene.setAttribute("reach-load-local",!0)},function(t,e,n){"use strict";var r=n(0);AFRAME.registerComponent("reach_text_panel",{schema:{id:{type:"string",default:r.a},direction:{type:"number",default:0},directionInDegrees:{type:"boolean",default:!1},inclination:{type:"number",default:0},distance:{type:"number",default:2},yHeight:{type:"number",default:1.6},backgroundSize:{type:"vec2",default:{x:1.5,y:1.5/8.5*11}},text:{type:"string",default:""},backgroundColor:{type:"color",default:"#ffffff"},backgroundOpacity:{type:"number",default:.7},backgroundShape:{type:"string",default:"plane"},img:{type:"string",default:r.a},color:{type:"color",default:"#000000"},link:{type:"string",default:r.a},arrow:{type:"boolean",default:!1},floor:{type:"boolean",default:!1}},init:function(){var t=this;this.imageLoadedHandler=function(e){console.log("NEW IMAGE:"+e.target.getObject3D("mesh").material.map.image.naturalHeight);var n=e.target.getObject3D("mesh").material.map.image,r=n.naturalWidth,i=n.naturalHeight;if(0!==r){var o=i/r,a=t.data.backgroundSize.x,s=o*a;console.log(`image: ${r}, ${i} ${a}, ${s}`),t.background.setAttribute("geometry",`primitive: ${t.data.backgroundShape}; width: ${a}; height: ${s}`)}}},update:function(t){this.head&&(this.background&&this.backgound.removeEventListener("materialtextureloaded",this.imageLoadedHandler),this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.outer=void 0,this.inner=void 0,this.background=void 0),this.data.id!==r.a&&this.el.setAttribute("id",this.data.id);var e=!0===this.data.floor?0:this.data.yHeight,n=!0===this.data.floor&&!1===this.data.arrow?-90:0;if(this.head=document.createElement("a-entity"),this.head.setAttribute("position",`0 ${e} 0`),this.outer=document.createElement("a-entity"),this.outer.setAttribute("rotation",`${this.data.inclination%12*30} ${!0===this.data.directionInDegrees?this.data.direction:this.data.direction%12*-30} 0`),this.inner=document.createElement("a-entity"),this.inner.setAttribute("position",`0 0 ${-1*this.data.distance}`),this.inner.setAttribute("rotation",`${n} 0 0`),this.background=document.createElement("a-entity"),this.background.setAttribute("id","background"),!1!==this.data.floor&&!1!==this.data.arrow||(this.background.setAttribute("geometry",`primitive: ${this.data.backgroundShape}; width: ${this.data.backgroundSize.x}; height: ${this.data.backgroundSize.y}`),this.data.img!==r.a?(this.background.addEventListener("materialtextureloaded",this.imageLoadedHandler),this.background.setAttribute("material",`shader: flat; opacity: ${this.data.backgroundOpacity}; src: ${Object(r.e)(this.data.img)}; transparent: true`)):this.background.setAttribute("material",`color: ${this.data.backgroundColor}; shader: flat; opacity: ${this.data.backgroundOpacity}`),this.background.setAttribute("text",`align: center; color: ${this.data.color}; width: 0.85; wrapCount: 18; value: ${this.data.text};`)),this.data.link!==r.a&&(this.background.setAttribute("class","clickable"),this.background.setAttribute("reach_passage_link",`name: ${this.data.link}; event: click`)),!0===this.data.arrow){var i=document.createElement("a-entity");i.setAttribute("reach_arrow",{distance:0,yHeight:-1*e,opacity:this.data.backgroundOpacity,color:this.data.backgroundColor,link:this.data.link}),this.background.appendChild(i)}this.head.appendChild(this.outer),this.outer.appendChild(this.inner),this.inner.appendChild(this.background),this.el.appendChild(this.head)},remove:function(){this.head&&(this.background&&this.background.removeEventListener("materialtextureloaded",this.imageLoadedHandler),this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.outer=void 0,this.inner=void 0,this.background=void 0)}})},function(t,e,n){"use strict";var r=n(0);AFRAME.registerComponent("reach_image_panel",{schema:{id:{type:"string",default:r.a},direction:{type:"number",default:0},directionInDegrees:{type:"boolean",default:!1},inclination:{type:"number",default:0},distance:{type:"number",default:2},yHeight:{type:"number",default:1.6},width:{type:"number",default:r.b},height:{type:"number",default:r.b},opacity:{type:"number",default:1},img:{type:"string",default:r.a},link:{type:"string",default:r.a},floor:{type:"boolean",default:!1}},init:function(){var t=this;this.imageLoadedHandler=function(e){var n=e.target.getObject3D("mesh").material.map.image,i=n.naturalWidth,o=n.naturalHeight;if(0!==i&&0!==o){var a=o/i;if(0!==a){var s=1,u=a;t.data.width!==r.b&&t.data.height==r.b?u=a*(s=t.data.width):t.data.width==r.b&&t.data.height!==r.b?s=(u=t.data.height)/a:t.data.width!==r.b&&t.data.height!==r.b&&(s=t.data.width,u=t.data.height),t.background.setAttribute("geometry",`primitive: plane; width: ${s}; height: ${u}`)}}}},update:function(t){this.head&&(this.background&&this.backgound.removeEventListener("materialtextureloaded",this.imageLoadedHandler),this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.outer=void 0,this.inner=void 0,this.background=void 0),this.data.id!==r.a&&this.el.setAttribute("id",this.data.id);var e=!0===this.data.floor?0:this.data.yHeight,n=!0===this.data.floor?-90:0;this.head=document.createElement("a-entity"),this.head.setAttribute("position",`0 ${e} 0`),this.outer=document.createElement("a-entity"),this.outer.setAttribute("rotation",`${this.data.inclination%12*30} ${!0===this.data.directionInDegrees?this.data.direction:this.data.direction%12*-30} 0`),this.inner=document.createElement("a-entity"),this.inner.setAttribute("position",`0 0 ${-1*this.data.distance}`),this.inner.setAttribute("rotation",`${n} 0 0`),this.background=document.createElement("a-entity"),this.background.setAttribute("id","background"),this.background.setAttribute("geometry","primitive: plane;"),this.data.img!==r.a&&(this.background.addEventListener("materialtextureloaded",this.imageLoadedHandler),this.background.setAttribute("material",`shader: flat; opacity: ${this.data.opacity}; src: ${Object(r.e)(this.data.img)}; transparent: true`)),this.data.link!==r.a&&(this.background.setAttribute("class","clickable"),this.background.setAttribute("reach_passage_link",`name: ${this.data.link}; event: click`)),this.head.appendChild(this.outer),this.outer.appendChild(this.inner),this.inner.appendChild(this.background),this.el.appendChild(this.head)},remove:function(){this.head&&(this.background&&this.background.removeEventListener("materialtextureloaded",this.imageLoadedHandler),this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.outer=void 0,this.inner=void 0,this.background=void 0)}})},function(t,e,n){"use strict";var r=n(0);AFRAME.registerComponent("reach_sound",{schema:{direction:{type:"number",default:0},directionInDegrees:{type:"boolean",default:!1},inclination:{type:"number",default:0},distance:{type:"number",default:2},yHeight:{type:"number",default:1.6},autoplay:{type:"boolean",default:!0},loop:{type:"boolean",default:!0},src:{type:"string",default:r.a}},init:function(){},update:function(t){this.head&&(this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.outer=void 0,this.soundElement=void 0),this.head=document.createElement("a-entity"),this.head.setAttribute("position",`0 ${this.data.yHeight} 0`),this.outer=document.createElement("a-entity"),this.outer.setAttribute("rotation",`${this.data.inclination%12*30} ${!0===this.data.directionInDegrees?this.data.direction:this.data.direction%12*-30} 0`),this.soundElement=document.createElement("a-sound"),this.soundElement.setAttribute("src",Object(r.e)(this.data.src)),this.soundElement.setAttribute("position",`0 0 ${this.data.distance}`),this.soundElement.setAttribute("autoplay",this.data.autoplay),this.soundElement.setAttribute("loop",this.data.loop),this.head.appendChild(this.outer),this.outer.appendChild(this.soundElement),this.el.appendChild(this.head)},remove:function(){this.head&&(this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.outer=void 0,this.soundElement=void 0)}})},function(t,e,n){"use strict";var r=n(0);AFRAME.registerComponent("reach_sky",{schema:{distance:{type:"number",default:5e3},transparent:{type:"boolean",default:!0},src:{type:"string",default:"#reach-default-360"}},init:function(){},update:function(t){this.sky&&(this.el.removeChild(this.sky),this.sky.destroy()),this.sky=document.createElement("a-sky"),this.sky.setAttribute("src",Object(r.e)(this.data.src)),this.sky.setAttribute("transparent",this.data.transparent),this.sky.setAttribute("radius",this.data.distance),this.sky.setAttribute("opacity",0),this.sky.setAttribute("animation",{property:"opacity",to:1,startEvents:"materialtextureloaded"}),this.el.appendChild(this.sky)},remove:function(){this.sky&&(this.el.removeChild(this.sky),this.sky.destroy())}})},function(t,e,n){"use strict";var r=n(0);AFRAME.registerComponent("reach_video",{schema:{autoplay:{type:"boolean",default:!0},loop:{type:"boolean",default:!0},videoId:{type:"string",default:"video"},src:{type:"string",default:"#reach-default-360"}},init:function(){},update:function(t){this.sky&&(this.el.removeChild(this.sky),this.sky.destroy());var e=document.querySelector(`#${this.data.videoId}`);if(!e){var n=document.querySelector("a-assets");(e=document.createElement("video")).setAttribute("src",Object(r.e)(this.data.src)),e.setAttribute("autoplay",this.data.autoplay),e.setAttribute("loop",this.data.loop),e.setAttribute("id",this.data.videoId),n.appendChild(e)}this.sky=document.createElement("a-videosphere"),this.sky.setAttribute("src",`#${this.data.videoId}`),this.el.appendChild(this.sky),!0===this.data.autoplay&&e.play()},remove:function(){this.sky&&(this.el.removeChild(this.sky),this.sky.destroy())}})},function(t,e,n){"use strict";var r=n(0);AFRAME.registerGeometry("arrow",{schema:{vertices:{default:["0.4932 0.1454 0","0.2432 0.1454 0","0.4932 0.1454 0.1","0.2432 0.1454 0.1","0.2432 -0.7615 0","0.2432 -0.7615 0.1","-0.2568 0.1454 0","-0.5068 0.1454 0","-0.5068 0.1454 0.1","-0.2568 0.1454 0.1","-0.2568 -0.7615 0","-0.2568 -0.7615 0.1","-0.0068 0.9011 0.1","-0.0068 0.9011 0"]},faces:{default:["1 3 4","1 4 2","5 2 4","5 4 6","7 10 9","7 9 8","7 11 12","7 12 10","6 12 11","6 11 5","8 14 7","1 2 14","2 7 14","9 10 13","10 4 13","3 13 4","10 12 6","10 6 4","14 13 3","14 3 1","2 5 11","2 11 7","14 8 9","14 9 13"]}},init:function(t){var e=new THREE.Geometry;e.vertices=t.vertices.map((function(t){var e=t.split(" ").map((function(t){return parseFloat(t)}));return new THREE.Vector3(e[0],e[1],e[2])})),console.log(e.vertices),e.computeBoundingBox(),t.faces.forEach((function(t){var n=t.split(" ").map((function(t){return parseInt(t)}));e.faces.push(new THREE.Face3(n[0]-1,n[1]-1,n[2]-1))})),e.mergeVertices(),console.log(e.faces),e.computeFaceNormals(),e.computeVertexNormals(),this.geometry=e}}),AFRAME.registerComponent("reach_arrow",{schema:{direction:{type:"number",default:0},directionInDegrees:{type:"boolean",default:!1},inclination:{type:"number",default:0},distance:{type:"number",default:2},yHeight:{type:"number",default:0},opacity:{type:"number",default:1},color:{type:"color",default:"#000000"},link:{type:"string",default:r.a}},init:function(){},update:function(t){this.head&&(this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.outer=void 0,this.inner=void 0,this.background=void 0),this.head=document.createElement("a-entity"),this.head.setAttribute("position",`0 ${this.data.yHeight} 0`),this.outer=document.createElement("a-entity"),this.outer.setAttribute("rotation",`${this.data.inclination%12*30} ${!0===this.data.directionInDegrees?this.data.direction:this.data.direction%12*-30} 0`),this.inner=document.createElement("a-entity"),this.inner.setAttribute("position",`0 0 ${-1*this.data.distance}`),this.background=document.createElement("a-entity"),this.background.setAttribute("id","arrow"),this.background.setAttribute("geometry","primitive: arrow;"),this.background.setAttribute("rotation","-90 0 0"),this.background.setAttribute("material",`color: ${this.data.color}; opacity: ${this.data.opacity}`),this.data.link!==r.a&&(this.background.setAttribute("class","clickable"),this.background.setAttribute("reach_passage_link",`name: ${this.data.link}; event: click`)),this.head.appendChild(this.outer),this.outer.appendChild(this.inner),this.inner.appendChild(this.background),this.el.appendChild(this.head)},remove:function(){this.head&&(this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.outer=void 0,this.inner=void 0,this.background=void 0)}})},function(t,e,n){"use strict";var r=n(0);function i(t){if(void 0===t)return console.log(`could not find position of passage with name: ${name}`),{x:0,y:0};var e=t.getAttribute("position");if(void 0===e)return{x:0,y:0};var n=e.split(",");return console.log(n),{x:n[0],y:n[1]}}function o(t){return window.story.passage(t)}function a(t){for(var e,n=/({\s*(.+)\s*})?\(\(\s*(.+)\s*\)\)/g,r=t.processedContent,i=[];null!==(e=n.exec(r));){var o={};e[1]&&(o=JSON.parse(e[1])),i.push({src:e[3],options:o})}return i}function s(t){return{text:t.processedContent.replace(/({\s*.+\s*})?`?(\[\[\s*.+\s*\]\]|`([^`]+)`|~~\s*.+\s*~~|\(\(\s*.+\s*\)\))\s*\n?/g,""),options:{direction:0}}}function u(t,e){if(!0===t.options.video)return function(t,e){var n=document.createElement("a-entity"),i=t.options;i.src=t.src,i.video=void 0;var o=Object(r.f)(t.options.mixin,i);return n.setAttribute("reach_video",o),n}(t);var n=document.createElement("a-entity"),i=t.options;i.src=t.src;var o=Object(r.f)(t.options.mixin,i);return n.setAttribute("reach_sky",o),n}function c(t){var e=document.createElement("a-entity"),n=t.options;n.link=t.link;var i=Object(r.f)(t.options.mixin,n,{img:t.img});return e.setAttribute("reach_image_panel",i),e}function d(t){var e=document.createElement("a-entity"),n=t.options;n.src=t.src;var i=Object(r.f)(t.options.mixin,n);return e.setAttribute("reach_sound",i),e}function l(t,e,n){var i=void 0,o=void 0;void 0!==t.twinePosition&&(o=!0,i=Object(r.d)(n,t.twinePosition)),void 0!==t.options.direction&&(o=!1,i=t.options.direction);var a=t.options.distance,s=t.options.inclination,u=void 0;if(t.options.width&&!t.options.height?u={x:t.options.width,y:t.options.width}:!t.options.width&&t.options.height?u={x:t.options.height,y:t.options.height}:t.options.width&&t.options.height&&(u={x:t.options.width,y:t.options.height}),void 0!==t.options.corners){var c=Object(r.h)(t.options.corners),d=Object(r.g)(-1*(a||2),c.corner1,c.corner2);o=!1,i=Object(r.c)(c.corner1.direction,c.corner2.direction),s=Object(r.c)(c.corner1.inclination,c.corner2.inclination),u={x:d.width,y:d.height},console.log(d)}var l=document.createElement("a-entity"),h={id:t.options.id,direction:i,directionInDegrees:o,inclination:s,distance:a,backgroundSize:u,backgroundColor:t.options.backgroundColor,backgroundOpacity:t.options.backgroundOpacity,backgroundShape:t.options.backgroundShape,img:t.options.img,color:t.options.color,text:t.text,link:t.link,arrow:t.options.arrow,floor:t.options.floor},p={direction:e+1,directionInDegrees:!1,backgroundSize:{x:1,y:1},backgroundColor:"#0000AA",backgroundOpacity:.7,color:"#FFFFFF",text:t.link},f=Object(r.f)(t.options.mixin,h,p);return l.setAttribute("reach_text_panel",f),l}function h(t,e,n){var i=void 0,o=void 0;void 0!==t.twinePosition&&(o=!0,i=Object(r.d)(n,t.twinePosition)),void 0!==t.options.direction&&(o=!1,i=t.options.direction);var a=t.options.distance,s=t.options.inclination,u=void 0;if(t.options.width&&!t.options.height?u={x:t.options.width,y:t.options.width/8.5*11}:!t.options.width&&t.options.height?u={x:t.options.height/11*8.5,y:t.options.height}:t.options.width&&t.options.height&&(u={x:t.options.width,y:t.options.height}),void 0!==t.options.corners){var c=Object(r.h)(t.options.corners),d=Object(r.g)(-1*(a||2),c.corner1,c.corner2);o=!1,i=Object(r.c)(c.corner1.direction,c.corner2.direction),s=Object(r.c)(c.corner1.inclination,c.corner2.inclination),u={x:d.width,y:d.height},console.log(d)}t.backgrounds&&t.backgrounds[0]&&t.backgrounds[0].src;var l=document.createElement("a-entity"),h={id:t.options.id,direction:i,directionInDegrees:o,inclination:s,distance:a,backgroundSize:u,backgroundColor:t.options.backgroundColor,backgroundOpacity:t.options.backgroundOpacity,backgroundShape:t.options.backgroundShape,img:t.options.img,color:t.options.color,text:t.text,arrow:t.options.arrow},p={direction:2*(e+1),directionInDegrees:!1},f=Object(r.f)(t.options.mixin,h,p);return l.setAttribute("reach_text_panel",f),l}AFRAME.registerComponent("reach_passage",{schema:{id:{type:"string",default:r.a},name:{type:"string",default:r.a},hideFromHistory:{type:"boolean",default:!1}},init:function(){},update:function(t){if(this.head&&(this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.passage=void 0),this.data.id!==r.a?this.passage=window.story.passage(this.data.id):this.data.name!==r.a&&(this.passage=window.story.passage(this.data.name)),void 0!==this.passage){!1===this.data.hideFromHistory&&window.story.history.push(this.passage.getAttribute("pid")),window.passage={id:this.passage.getAttribute("pid"),name:this.passage.getAttribute("name"),tags:this.passage.getAttribute("tags"),position:i(this.passage),source:this.passage.textContent},this.head=document.createElement("a-entity");var e=this.head,n=window.story.render(this.passage.getAttribute("pid"));this.passage.processedContent=n;for(var p=a(this.passage),f=0;f<p.length;f++){var g=u(p[f],window.passage.name);null!==g&&e.appendChild(g)}var y=function(t){for(var e,n=/(^|({\s*(.+)\s*})|[^`])\[\[\s*((.+)\s*\|\s*(.+)\s*|(.+)\s*)\]\]/g,r=t.processedContent,a=[];null!==(e=n.exec(r));){var s={};if(e[2]&&(s=JSON.parse(e[1])),e[5]){var u=o(e[6]);a.push({text:e[5],link:e[6],options:s,twinePosition:i(u)})}else{u=o(e[7]);a.push({text:e[7],link:e[7],options:s,twinePosition:i(u)})}}return a}(this.passage);for(f=0;f<y.length;f++){var v=l(y[f],f,window.passage.position);e.appendChild(v)}var m=function(t){for(var e,n=/({\s*(.+)\s*})?`\[\[\s*((.+)\s*\|\s*(.+)\s*|(.+)\s*)\]\]/g,r=t.processedContent,u=[];null!==(e=n.exec(r));){var c={};if(e[1]&&(c=JSON.parse(e[1])),e[4]){(l=o(e[5])).processedContent=window.story.render(l.getAttribute("pid"));var d=a(l);u.push({text:s(l).text,options:c,backgrounds:d,twinePosition:i(l)})}else{var l;(l=o(e[6])).processedContent=window.story.render(l.getAttribute("pid"));d=a(l);u.push({text:s(l).text,options:c,backgrounds:d,twinePosition:i(l)})}}return u}(this.passage);for(f=0;f<m.length;f++){var b=h(m[f],f,window.passage.position);e.appendChild(b)}var _=function(t){for(var e,n=/(^|({\s*(.+)\s*})|[^`])\[img\[(\s*(.+)\s*)\](\s*\]|((.+))\])/g,r=t.processedContent,i=[];null!==(e=n.exec(r));){var o={};e[2]&&(o=JSON.parse(e[2])),i.push({img:e[5],link:e[7],options:o})}return i}(this.passage);for(f=0;f<_.length;f++){b=c(_[f]);e.appendChild(b)}var w=function(t){for(var e,n=/({\s*(.+)\s*})?~~\s*(.+)\s*~~/g,r=t.processedContent,i=[];null!==(e=n.exec(r));){var o={};e[1]&&(o=JSON.parse(e[1])),i.push({src:e[3],options:o})}return i}(this.passage);for(f=0;f<w.length;f++){var k=d(w[f]);e.appendChild(k)}if(0===p.length){var A=u({options:{transparent:!1}},window.passage.name);e.appendChild(A)}this.el.appendChild(this.head)}else console.log("reach warning: no passage provided to reach_passage component")},remove:function(){this.head&&(this.el.removeChild(this.head),this.head.destroy(),this.head=void 0,this.passage=void 0)}})}]);